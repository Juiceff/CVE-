# CVE-2019-14287：sudo漏洞提权复现   (朱俊峰 045)
## 一、漏洞分析
* 可在linux中sudo版本低于1.8.28下实现
* 可使受限制的sudo用户不受限制执行root命令
* 受限制的sudo用户必须被安全策略限制
## 二、复现环境
* ubuntu18.04版本，在虚拟机里运行，sudo版本如下：
![](https://github.com/Juiceff/ucore_picture/raw/master/sudo/3.png)

## 三、复现过程
**模拟受限制的sudo用户**
* 修改文件`/etc /sudoers`如下：
![](https://github.com/Juiceff/ucore_picture/blob/master/sudo/4.png)
1. 赋予`test`用户所有权限
2. 限制其以root执行`ip`命令   
**终端实现**
![](https://github.com/Juiceff/ucore_picture/blob/master/sudo/5.png)
1. 首先输入`sudo ip`执行，发现被禁止了
2. 然后输入`sudo -u#-1 /bin/ip`，发现`ip`命令被执行了
3. ***当把禁止的命令改为`/bin/bash`，进行提权时则是直接提权到root用户权限，而不是简简单单的只执行像ip一样的命令***
**之所以会产生这个漏洞，是因为将用户 ID 转换为用户名的函数会将 -1（或无效等效的 4294967295）误认为是 0，而这正好是 root 用户 User ID 。此外，由于通过 -u 选项指定的 User ID 在密码数据库中不存在，因此不会运行任何 PAM 会话模块**
******
